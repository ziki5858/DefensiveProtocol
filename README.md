# MessageU – Secure Messaging System (Client & Server)

This project implements a simplified encrypted messaging protocol, inspired by secure communication apps. The system includes:

- A C++ client
- A Python server
- Secure communication using AES and RSA cryptography
- Structured protocol with fixed-size headers and message types

---

## 🎯 Project Goals

- Demonstrate secure peer-to-peer messaging using public key and symmetric key encryption
- Implement a custom client-server protocol with support for:
  - User registration
  - Public key retrieval
  - Encrypted text messaging
  - Symmetric key exchange
  - Fetching waiting messages

---

## 📁 Project Structure

```
defencivy-project/
│
├── client/                   # C++ client implementation
│   ├── Client.cpp            # Main client logic
│   ├── Connection.cpp        # TCP socket abstraction (Windows)
│   ├── CryptoManager.cpp     # RSA and AES encryption logic
│   ├── ProtocolBuilder.cpp   # Builds protocol-compliant requests
│   ├── ProtocolParser.cpp    # Parses responses from server
│   ├── main.cpp              # Entry point
│   ├── me.info               # Client identity file (autogenerated)
│   └── server.info           # Contains IP and port of server
│
├── server/                   # Python server implementation
│   ├── server.py             # Main server listener
│   ├── protocol.py           # Handles header parsing/response building
│   ├── registry.py           # Manages registered clients and messages
│   └── handlers.py           # Per-message-type handlers
```

---

## 🚀 Running the Project

### 🧩 Prerequisites

- Windows (client uses WinSock2)
- Python 3.x
- `cryptopp` (linked statically into the client)
- CMake + MinGW (or CLion)
- `server.info` file containing `127.0.0.1:1234`

---

### 🖥️ Compile the Client (C++)

1. Open in CLion or run:
   ```bash
   mkdir build
   cd build
   cmake ..
   cmake --build .
   ```

2. Or manually compile with g++:
   ```bash
   g++ -std=c++17 *.cpp -lcryptopp -lws2_32 -o client.exe
   ```

---

### 🐍 Run the Server (Python)

From the `server/` directory:

```bash
python server.py
```

Server will start listening on port `1234`.

---

## 🧪 Basic Usage

From the client:

```text
110) Register
120) List clients
130) Get public key
140) Fetch messages
150) Send text
151) Request sym key
152) Send sym key
0) Exit
```

Typical interaction:

1. Register users (once per user)
2. List clients (120)
3. Get public key of recipient (130)
4. Send/Request symmetric key (151, 152)
5. Send text message (150)
6. Recipient runs (140) to fetch messages

---

## 🧠 Notes & Design Decisions

- **RSA key pair** is generated locally per client on registration.
- **me.info** stores the client ID and private key. To test multiple users on one machine, run the client from different folders or adjust the code to support per-user files (`me_ishay.info`, etc.).
- The client keeps in-memory maps of:
  - Symmetric keys per peer (`symKeyStore`)
  - Public keys per peer (`peerPubKeys`)
  - Registered usernames (`clientsMap`)

---

## ✅ Features Implemented (per course requirements)

- ✔️ Structured binary protocol with headers
- ✔️ Unique user registration with client ID
- ✔️ Public key exchange
- ✔️ RSA-encrypted symmetric key exchange
- ✔️ AES-encrypted messages with IV
- ✔️ Message storage and delivery via server
- ✔️ Clear debug output for testing

---

## 🛠️ Potential Improvements

- Support for deleting/refreshing `me.info` easily
- GUI client
- File transfer support
- Persistent database (instead of in-memory registry)
- Encrypted `me.info`

---

## 📚 Author

- Student: **Ishay Abakiev**
- Final Project – Open University, Maman 15

---
⚠️ License: All Rights Reserved  
This project is public for viewing only.  
Any copying, distribution, or usage without explicit permission is strictly forbidden.
